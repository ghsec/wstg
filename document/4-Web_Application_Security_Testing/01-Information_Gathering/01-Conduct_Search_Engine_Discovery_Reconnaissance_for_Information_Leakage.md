# Проведите разведку обнаружения поисковых систем для утечки информации

|ID          |
|------------|
|WSTG-INFO-01|

## Резюме

Для того, чтобы поисковые системы работали, компьютерные программы (или `robots`) регулярно получать данные (упоминается как [crawling](https://en.wikipedia.org/wiki/Web_crawler)) с миллиардов страниц в Интернете. Эти программы находят веб-контент и функциональность, переходя по ссылкам с других страниц или просматривая ситемы. Если веб-сайт использует специальный файл с именем `robots.txt` для списка страниц, которые он не хочет извлекать поисковыми системами, то перечисленные там страницы будут игнорироваться. Это основной обзор - Google предлагает более подробное объяснение [how a search engine works](https://support.google.com/webmasters/answer/70897?hl=en).

Тестеры могут использовать поисковые системы для проведения разведки на веб-сайтах и в веб-приложениях. Существуют прямые и косвенные элементы для обнаружения и разведки поисковых систем: прямые методы относятся к поиску индексов и связанного с ними контента из кешей, в то время как косвенные методы относятся к обучению конфиденциальной информации о дизайне и конфигурации с помощью поисковых форумов, групп новостей и сайтов тендеров.

После того, как робот поисковой системы завершил ползание, он начинает индексировать веб-контент на основе тегов и связанных атрибутов, таких как `<TITLE> `, чтобы вернуть соответствующие результаты поиска. Если файл `robots.txt` не обновляется в течение срока службы веб-сайта, и встроенные метатеги HTML, которые инструктируют роботов не индексировать контент, не использовались, то индексы могут содержать веб-контент, не предназначенный быть включенным владельцами. Владельцы веб-сайтов могут использовать ранее упомянутые `robots.txt`, метатеги HTML, аутентификацию и инструменты, предоставляемые поисковыми системами, для удаления такого контента.

## Цели теста

- Определите, какая конфиденциальная информация о конструкции и конфигурации приложения, системы или организации раскрывается напрямую (на веб-сайте организации) или косвенно (через сторонние службы).

## Как проверить

Используйте поисковую систему для поиска потенциально конфиденциальной информации. Это может включать в себя:

- сетевые схемы и конфигурации;
- архивные сообщения и электронные письма администраторов или других ключевых сотрудников;
- процедуры входа в систему и форматы имени пользователя;
- имена пользователей, пароли и личные ключи;
- сторонние или облачные файлы конфигурации службы;
- раскрытие содержимого сообщения об ошибке; а также
- разработка, тестирование, тестирование на приемку пользователей (UAT) и постановка версий сайтов.

### Поисковые системы

Не ограничивайте тестирование только одним поставщиком поисковых систем, поскольку разные поисковые системы могут генерировать разные результаты. Результаты поисковой системы могут варьироваться несколькими способами, в зависимости от того, когда движок последний ползучий контент, и алгоритма, который движок использует для определения соответствующих страниц. Рассмотрим использование следующих (в алфавитном порядке) поисковых систем:

- [Baidu](https://www.baidu.com/), Китай [самый популярный](https://en.wikipedia.org/wiki/Web_search_engine#Market_share) поисковая система.
- [Bing](https://www.bing.com/), поисковая система, принадлежащая и управляемая Microsoft, и вторая [most popular](https://en.wikipedia.org/wiki/Web_search_engine#Market_share) по всему миру. Поддерживает [advanced search keywords](http://help.bing.microsoft.com/#apex/18/en-US/10001/-1).
- [binsearch.info](https://binsearch.info/), поисковая система для бинарных групп новостей Usenet.
- [Common Crawl](https://commoncrawl.org/), "открытый репозиторий данных веб-ползания, к которым может обращаться и анализировать любой желающий."
- [DuckDuckGo](https://duckduckgo.com/), ориентированная на конфиденциальность поисковая система, которая собирает результаты из разных [sources](https://help.duckduckgo.com/results/sources/). Поддерживает [search syntax](https://help.duckduckgo.com/duckduckgo-help-pages/results/syntax/).
- [Google](https://www.google.com/), который предлагает мир [most popular](https://en.wikipedia.org/wiki/Web_search_engine#Market_share) поисковая система и использует систему ранжирования, чтобы попытаться вернуть наиболее релевантные результаты. Поддерживает [search operators](https://support.google.com/websearch/answer/2466433).
- [Internet Archive Wayback Machine](https://archive.org/web/), "создание цифровой библиотеки интернет-сайтов и других культурных артефактов в цифровом виде."
- [Startpage](https://www.startpage.com/), поисковая система, которая использует результаты Google без сбора личной информации через трекеры и журналы. Поддерживает [search operators](https://support.startpage.com/index.php?/Knowledgebase/Article/View/989/0/advanced-search-which-search-operators-are-supported-by-startpagecom).
- [Shodan](https://www.shodan.io/), служба поиска подключенных к Интернету устройств и услуг. Варианты использования включают ограниченный бесплатный план, а также планы платной подписки.

И DuckDuckGo, и Startpage предлагают пользователям некоторую повышенную конфиденциальность, не используя трекеры или ведение журналов. Это может обеспечить уменьшенную утечку информации о тестере.

### Операторы поиска

Оператор поиска - это специальное ключевое слово или синтаксис, который расширяет возможности обычных поисковых запросов и может помочь получить более конкретные результаты. Они обычно принимают форму `operator: query`. Вот некоторые часто поддерживаемые поисковые операторы:

- `site:` ограничит поиск предоставленным доменом.
- `inurl:` будет возвращать только те результаты, которые включают ключевое слово в URL .
- `intitle:` будет возвращать только те результаты, которые имеют ключевое слово в заголовке страницы.
- `intext:` или `inbody:` будет искать только ключевое слово в теле страниц.
- `filetype:` будет соответствовать только определенному типу файла, т.е. png, или php.

Например, чтобы найти веб-контент owasp.org, проиндексированный типичной поисковой системой, требуется синтаксис:

```text
site:owasp.org
```

![Google Site Operation Search Result Example](images/Google_site_Operator_Search_Results_Example_20200406.png)\
*Figure 4.1.1-1: Google Site Operation Search Result Example*

### Просмотр кэшированного контента

Для поиска содержимого, которое было ранее проиндексировано, используйте оператор `cache:`. Это полезно для просмотра контента, который мог измениться с момента его индексации или который может быть недоступен. Не все поисковые системы предоставляют кэшированный контент для поиска; самый полезный источник на момент написания статьи - Google.

Для просмотра `owasp.org` в кешированном виде синтаксис:

```text
cache:owasp.org
```

![Google Cache Operation Search Result Example](images/Google_cache_Operator_Search_Results_Example_20200406.png)\
*Figure 4.1.1-2: Google Cache Operation Search Result Example*

### Google Hacking, или Dorking

Поиск с операторами может быть очень эффективной техникой обнаружения в сочетании с креативностью тестера. Операторы могут быть объединены для эффективного обнаружения определенных видов конфиденциальных файлов и информации. Эта техника называется [Google hacking](https://en.wikipedia.org/wiki/Google_hacking) или Dorking, также возможно с использованием других поисковых систем, если поддерживаются операторы поиска.

База данных dork-ов, таких как [Google Hacking Database](https://www.exploit-db.com/google-hacking-database), это полезный ресурс, который может помочь раскрыть конкретную информацию. Некоторые категории придурков, доступные в этой базе данных, включают:

- предгорья
- Файлы, содержащие имена пользователей
- Чувствительные каталоги
- Обнаружение веб-сервера
- Уязвимые файлы
- Уязвимые серверы
- Сообщения об ошибках
- Файлы, содержащие сочную информацию
- Файлы, содержащие пароли
- Чувствительная информация о покупках в Интернете

## Восстановление

Внимательно рассмотрите чувствительность информации о дизайне и конфигурации, прежде чем она будет опубликована в Интернете.

Периодически проверяйте чувствительность существующей информации о дизайне и конфигурации, которая публикуется в Интернете.
