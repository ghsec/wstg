# Разрешение тестового файла

| ID |
| ------------- |
| WSTG-CONF-09 |

## Резюме

Когда ресурсу присваивается настройка разрешений, которая обеспечивает доступ к более широкому кругу участников, чем требуется, это может привести к раскрытию конфиденциальной информации или изменению этого ресурса непреднамеренными сторонами. Это особенно опасно, когда ресурс связан с конфигурацией программы, выполнением или конфиденциальными пользовательскими данными.

Ярким примером является файл выполнения, который может быть выполнен неавторизованными пользователями. В другом примере информация об учетной записи или значение токена для доступа к API - все чаще встречающемуся в современных веб-сервисах или микросервисах - может храниться в файле конфигурации, разрешения которого по умолчанию устанавливаются на мировоззрение из установки. Такие конфиденциальные данные могут быть обнаружены внутренними злоумышленниками хоста или удаленным злоумышленником, который скомпрометировал службу с другими уязвимостями, но получил только обычные привилегии пользователя.

## Цели теста

- Просмотрите и определите любые мошеннические разрешения для файлов.

## Как проверить

В Linux используйте команду `ls` для проверки прав на файл. Кроме того, `namei` также можно использовать для рекурсива перечисления разрешений файлов.

`$ namei -l /PathToCheck/ `

Файлы и каталоги, которые требуют тестирования разрешения файлов, включают, но не ограничиваются:

- Веб-файлы / каталог
- Конфигурация файлов / каталога
- Чувствительные файлы (зашифрованные данные, пароль, ключ) / каталог
- Файлы журналов (журналы безопасности, журналы операций, журналы администраторов) / каталог
- Исполняемые файлы (сценарии, EXE, JAR, класс, PHP, ASP) / каталог
- Файлы / каталог базы данных
- Temp файлы / каталог
- Загрузить файлы / каталог

## Восстановление

Правильно установите разрешения для файлов и каталогов, чтобы неавторизованные пользователи не могли без необходимости получать доступ к критически важным ресурсам.

## Инструменты

- [Windows AccessEnum](https://technet.microsoft.com/en-us/sysinternals/accessenum)
- [Windows AccessChk](https://technet.microsoft.com/en-us/sysinternals/accesschk)
- [Linux namei](https://linux.die.net/man/1/namei)

## References

- [CWE-732: Incorrect Permission Assignment for Critical Resource](https://cwe.mitre.org/data/definitions/732.html)
