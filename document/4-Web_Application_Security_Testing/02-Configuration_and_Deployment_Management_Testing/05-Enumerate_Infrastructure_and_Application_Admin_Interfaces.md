# Перечислять интерфейсы инфраструктуры и администрирования приложений

|ID          |
|------------|
|WSTG-CONF-05|

## Резюме

Интерфейсы администратора могут присутствовать в приложении или на сервере приложений, чтобы определенные пользователи могли выполнять привилегированные действия на сайте. Должны быть проведены тесты, чтобы определить, может ли и как эта привилегированная функциональность быть доступна неавторизованному или стандартному пользователю.

Для приложения может потребоваться интерфейс администратора, чтобы позволить привилегированному пользователю получить доступ к функциональности, которая может вносить изменения в функции сайта. Такие изменения могут включать в себя:

- предоставление учетной записи пользователя
- дизайн сайта и макет
- манипулирование данными
- изменение конфигурации

Во многих случаях такие интерфейсы не имеют достаточного контроля для защиты их от несанкционированного доступа. Тестирование направлено на обнаружение этих интерфейсов администратора и доступ к функциональности, предназначенной для привилегированных пользователей.

## Цели теста

- Определите скрытые интерфейсы и функции администратора.

## Как проверить

### Тестирование черного ящика

В следующем разделе описаны векторы, которые могут использоваться для проверки наличия административных интерфейсов. Эти методы могут также использоваться для проверки связанных с этим проблем, включая повышение привилегий, и описаны в других разделах данного руководства (например, [Testing for bypassing authorization schema](../05-Authorization_Testing/02-Testing_for_Bypassing_Authorization_Schema.md) and [Testing for Insecure Direct Object References](../05-Authorization_Testing/04-Testing_for_Insecure_Direct_Object_References.md) более подробно.

- Справочник и перечисление файлов. Административный интерфейс может присутствовать, но не доступен для тестера. Попытка угадать путь административного интерфейса может быть такой же простой, как запрос: * / администратор или / администратор и т. Д..* или в некоторых сценариях можно обнаружить в течение нескольких секунд, используя [Google dorks](https://www.exploit-db.com/google-hacking-database).
- Существует множество инструментов для грубой форсировки содержимого сервера, см. Раздел «Инструменты» ниже для получения дополнительной информации. Тестер может также определить имя файла страницы администрирования. Принудительный просмотр на идентифицированной странице может обеспечить доступ к интерфейсу.
- Комментарии и ссылки в исходном коде. Многие сайты используют общий код, который загружается для всех пользователей сайта. Изучив весь источник, отправленный клиенту, можно обнаружить ссылки на функции администратора, которые следует изучить.
- Просмотр документации сервера и приложения. Если сервер приложений или приложение развернуты в конфигурации по умолчанию, возможно, будет возможно получить доступ к интерфейсу администрирования, используя информацию, описанную в конфигурации, или справочную документацию. Списки паролей по умолчанию следует просматривать, если найден административный интерфейс и требуются учетные данные.
- Публично доступная информация. Многие приложения, такие как WordPress, имеют административные интерфейсы по умолчанию .
- Альтернативный порт сервера. Интерфейсы администрирования можно увидеть на другом порту на хосте, чем в основном приложении. Например, интерфейс администрирования Apache Tomcat часто можно увидеть на порту 8080.
- Параметр подделки. Параметр GET или POST или переменная cookie могут потребоваться для включения функции администратора. Подсказки к этому включают наличие скрытых полей, таких как:

```html
<input type="hidden" name="admin" value="no">
```

или в печенье:

`Cookie: session_cookie; useradmin=0`

После обнаружения административного интерфейса комбинация вышеуказанных методов может использоваться для попытки обойти аутентификацию. Если это не удастся, тестер может захотеть предпринять попытку атаки грубой силы. В таком случае тестер должен знать о возможности блокировки административного счета, если такая функциональность присутствует.

### Тестирование серой коробки

Для обеспечения упрочнения необходимо провести более детальное изучение сервера и компонентов приложения (т.е. страницы администратора доступны не каждому с помощью IP-фильтрации или других элементов управления) и, где это применимо, проверки того, что все компоненты не используют учетные данные или конфигурации по умолчанию.
Исходный код должен быть проверен, чтобы гарантировать, что модель авторизации и аутентификации обеспечивает четкое разделение обязанностей между обычными пользователями и администраторами сайта. Функции пользовательского интерфейса, общие для обычных пользователей и пользователей администратора, должны быть проверены, чтобы обеспечить четкое разделение между чертежом таких компонентов и утечкой информации из такой общей функциональности.

Каждая веб-структура может иметь свои собственные страницы или путь администратора по умолчанию. Например

WebSphere:

```html
/admin
/admin-authz.xml
/admin.conf
/admin.passwd
/admin/*
/admin/logon.jsp
/admin/secure/logon.jsp
```

PHP:

```html
/phpinfo
/phpmyadmin/
/phpMyAdmin/
/mysqladmin/
/MySQLadmin
/MySQLAdmin
/login.php
/logon.php
/xmlrpc.php
/dbadmin
```

FrontPage:

```html
/admin.dll
/admin.exe
/administrators.pwd
/author.dll
/author.exe
/author.log
/authors.pwd
/cgi-bin
```

WebLogic:

```html
/AdminCaptureRootCA
/AdminClients
/AdminConnections
/AdminEvents
/AdminJDBC
/AdminLicense
/AdminMain
/AdminProps
/AdminRealm
/AdminThreads
```

WordPress:

```html
wp-admin/
wp-admin/about.php
wp-admin/admin-ajax.php
wp-admin/admin-db.php
wp-admin/admin-footer.php
wp-admin/admin-functions.php
wp-admin/admin-header.php
```

## Tools

- [OWASP ZAP - Forced Browse](https://www.zaproxy.org/docs/desktop/addons/forced-browse/) is a currently maintained use of OWASP's previous DirBuster project.
- [THC-HYDRA](https://github.com/vanhauser-thc/thc-hydra) is a tool that allows brute-forcing of many interfaces, including form-based HTTP authentication.
- A brute forcer is much better when it uses a good dictionary, for example the [netsparker](https://www.netsparker.com/blog/web-security/svn-digger-better-lists-for-forced-browsing/) dictionary.

## References

- [Cirt: Default Password list](https://cirt.net/passwords)
- [FuzzDB can be used to do brute force browsing admin login path](https://github.com/fuzzdb-project/fuzzdb/blob/master/discovery/predictable-filepaths/login-file-locations/Logins.txt)
- [Common admin or debugging parameters](https://github.com/fuzzdb-project/fuzzdb/blob/master/attack/business-logic/CommonDebugParamNames.txt)
