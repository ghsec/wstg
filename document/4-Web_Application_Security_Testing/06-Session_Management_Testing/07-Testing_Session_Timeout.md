# Время проведения сеанса тестирования

| ID |
| ------------- |
| WSTG-SESS-07 |

## Резюме

На этом этапе тестировщики проверяют, что приложение автоматически регистрирует пользователя, когда этот пользователь простаивает в течение определенного периода времени, гарантируя, что невозможно «повторно использовать» тот же сеанс и что в кеше браузера не хранятся конфиденциальные данные. ,.

Все приложения должны реализовать тайм-аут простоя или неактивности для сеансов. Этот тайм-аут определяет количество времени, в течение которого сеанс будет оставаться активным в случае отсутствия активности со стороны пользователя, закрытие и аннулирование сеанса в течение определенного периода ожидания с момента последнего HTTP-запроса, полученного веб-приложением для данного идентификатора сеанса. Наиболее подходящим тайм-аутом должен быть баланс между безопасностью (более короткий тайм-аут) и удобство использования (дольше) и сильно зависит от уровня чувствительности данных, обрабатываемых приложением. Например, 60-минутное время выхода на публичный форум может быть приемлемым, но такое долгое время будет слишком большим в приложении для домашнего банкинга (где рекомендуется максимальный тайм-аут 15 минут). В любом случае, любое приложение, которое не обеспечивает выход из системы на основе тайм-аута, должно считаться небезопасным, если только такое поведение не требуется конкретным функциональным требованием.

Простоя времени ожидания ограничивает вероятность того, что злоумышленнику придется угадать и использовать действительный идентификатор сеанса от другого пользователя, и при определенных обстоятельствах может защитить общедоступные компьютеры от повторного использования сеанса. Однако, если злоумышленник может перехватить данный сеанс, время ожидания не ограничивает действия злоумышленника, поскольку он может периодически генерировать активность в сеансе, чтобы сеанс оставался активным в течение более длительных периодов времени.

Управление тайм-аутом сеанса и истечение срока действия должны выполняться на стороне сервера. Если некоторые данные под контролем клиента используются для обеспечения тайм-аута сеанса, например, с использованием значений cookie или других параметров клиента для отслеживания ссылок на время (например,. количество минут с момента входа в систему), злоумышленник может манипулировать ими, чтобы продлить продолжительность сеанса. Таким образом, приложение должно отслеживать неактивность времени на стороне сервера и, после истечения тайм-аута, автоматически аннулировать сеанс текущего пользователя и удалять все данные, хранящиеся на клиенте.

Оба действия должны быть выполнены осторожно, чтобы избежать появления слабых сторон, которые могут быть использованы злоумышленником для получения несанкционированного доступа, если пользователь забыл выйти из приложения. Более конкретно, что касается функции выхода из системы, важно обеспечить, чтобы все токены сеанса (например,. файлы cookie) должным образом уничтожаются или становятся непригодными для использования, и что на стороне сервера применяются надлежащие средства управления для предотвращения повторного использования токенов сеанса. Если такие действия не выполняются должным образом, злоумышленник может воспроизвести эти токены сеанса, чтобы «восстановить» сеанс законного пользователя и выдать себя за него (эта атака обычно называется «воспроизведение куки»). Конечно, смягчающим фактором является то, что злоумышленник должен иметь доступ к тем токенам (которые хранятся на ПК жертвы), но в различных случаях это может быть невозможно или особенно сложно.

Наиболее распространенным сценарием для такого рода атак является общедоступный компьютер, который используется для доступа к некоторой частной информации (например,., веб-почта, онлайн-банк-счет). Если пользователь удаляется от компьютера без явного выхода из системы и тайм-аут сеанса не применяется в приложении, злоумышленник может получить доступ к той же учетной записи, просто нажав кнопку «назад» браузера.

## Цели теста

- Убедитесь, что существует сложный тайм-аут сеанса.

## Как проверить

### Тестирование черного ящика

Тот же подход, что и в [Testing for logout functionality](06-Testing_for_Logout_Functionality.md) раздел может применяться при измерении выхода из тайм-аута.
Методология тестирования очень похожа. Во-первых, тестировщики должны проверить, существует ли тайм-аут, например, войдя в систему и ожидая, когда выйдет тайм-аут. Как и в функции выхода из системы, после истечения тайм-аута все токены сеанса должны быть уничтожены или непригодны для использования.

Затем, если тайм-аут настроен, тестировщики должны понимать, применяется ли тайм-аут клиентом или сервером (или обоими). Если cookie-файл сеанса непостоянен (или, в более общем смысле, cookie-файл сеанса не хранит никаких данных о времени), тестировщики могут предположить, что тайм-аут применяется сервером. Если cookie сеанса содержит некоторые данные, связанные со временем (например,., время входа в систему, время последнего доступа или дата истечения срока действия для постоянного файла cookie), тогда возможно, что клиент участвует в обеспечении соблюдения тайм-аута. В этом случае тестировщики могут попытаться изменить cookie (если он не криптографически защищен) и посмотреть, что происходит с сеансом. Например, тестировщики могут установить дату истечения срока действия cookie в будущем и посмотреть, можно ли продлить сеанс.

Как правило, все должно проверяться на стороне сервера, и не должно быть возможности, перенастроив cookie-файлы сеанса в прежние значения, снова получить доступ к приложению.

### Тестирование серой коробки

Тестер должен проверить это:

- Функция выхода из системы эффективно уничтожает все токены сеанса или, по крайней мере, делает их непригодными для использования
- Сервер выполняет правильные проверки состояния сеанса, позволяя злоумышленнику воспроизводить ранее уничтоженные идентификаторы сеанса
- Тайм-аут применяется и должным образом применяется сервером. Если сервер использует время истечения, которое считывается из токена сеанса, который отправляется клиентом (но это не рекомендуется), то токен должен быть криптографически защищен от взлома.

Обратите внимание, что самое важное для приложения - сделать сеанс недействительным на стороне сервера. Обычно это означает, что код должен вызывать соответствующие методы, например,. `HttpSession.invalidate ()` в Java и `Session.abandon ()` в .NET. Очистка файлов cookie от браузера рекомендуется, но не является строго необходимой, поскольку, если сеанс должным образом признан недействительным на сервере, наличие файлов cookie в браузере не поможет злоумышленнику.

## References

### OWASP Resources

- [Session Management Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html)
