# Тестирование на сеанс Puzzling

| ID |
| ------------- |
| WSTG-SESS-08 |

## Резюме

Перегрузка переменной сеанса (также известная как «Озадачивание сеанса») - это уязвимость уровня приложения, которая может позволить злоумышленнику выполнять различные вредоносные действия, включая, помимо прочего:

- Обходите эффективные механизмы обеспечения аутентификации и выдавайте себя за законных пользователей.
- Повысить привилегии учетной записи вредоносного пользователя в среде, которая в противном случае была бы признана надежной.
- Пропустите квалификационные фазы в многофазных процессах, даже если процесс включает в себя все обычно рекомендуемые ограничения уровня кода.
- Управлять значениями на стороне сервера косвенными методами, которые невозможно предсказать или обнаружить.
- Выполнять традиционные атаки в местах, которые ранее были недоступны или даже считались безопасными.

Эта уязвимость возникает, когда приложение использует одну и ту же переменную сеанса для более чем одной цели. Злоумышленник может получить доступ к страницам в порядке, непредвиденном разработчиками, так что переменная сеанса устанавливается в одном контексте, а затем используется в другом.

Например, злоумышленник может использовать перегрузку переменной сеанса, чтобы обойти механизмы защиты аутентификации приложений, которые обеспечивают аутентификацию, путем проверки существования переменных сеанса, которые содержат значения, связанные с идентификацией, которые обычно хранятся в сеансе после успешного процесса аутентификации. Это означает, что злоумышленник сначала получает доступ к местоположению в приложении, которое устанавливает контекст сеанса, а затем получает доступ к привилегированным местоположениям, которые проверяют этот контекст.

Например - вектор атаки обхода аутентификации может быть выполнен путем доступа к общедоступной точке входа (например,. страница восстановления пароля), которая заполняет сеанс идентичной переменной сеанса на основе фиксированных значений или исходного пользовательского ввода.

## Цели теста

- Определите все переменные сеанса.
- Разорвать логический поток генерации сеанса.

## Как проверить

### Тестирование черного ящика

Эту уязвимость можно обнаружить и использовать, перечислив все переменные сеанса, используемые приложением, и в каком контексте они действительны. В частности, это возможно путем доступа к последовательности точек входа, а затем изучения точек выхода. В случае тестирования в черном ящике эта процедура сложна и требует некоторой удачи, поскольку каждая отдельная последовательность может привести к другому результату.

#### Примеры

Очень простым примером может быть функция сброса пароля, которая в точке входа может попросить пользователя предоставить некоторую идентификационную информацию, такую как имя пользователя или адрес электронной почты. Затем эта страница может заполнять сеанс этими идентифицирующими значениями, которые получены непосредственно со стороны клиента или получены из запросов или расчетов на основе полученного ввода. На этом этапе в приложении могут быть некоторые страницы, которые показывают личные данные на основе этого объекта сеанса. Таким образом, злоумышленник может обойти процесс аутентификации.

### Тестирование серой коробки

Наиболее эффективный способ обнаружения этих уязвимостей - проверка исходного кода.

## Восстановление

Переменные сеанса следует использовать только для одной последовательной цели.

## References

- [Session Puzzles](https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/puzzlemall/Session%20Puzzles%20-%20Indirect%20Application%20Attack%20Vectors%20-%20May%202011%20-%20Whitepaper.pdf)
- [Session Puzzling and Session Race Conditions](http://sectooladdict.blogspot.com/2011/09/session-puzzling-and-session-race.html)
