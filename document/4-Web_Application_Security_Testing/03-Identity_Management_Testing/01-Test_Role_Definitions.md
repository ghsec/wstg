# Определения тестовых ролей

| ID |
| ------------- |
| WSTG-IDNT-01 |

## Резюме

Приложения имеют несколько типов функций и услуг, и для них требуются разрешения на доступ в зависимости от потребностей пользователя. Этот пользователь может быть:

- администратор, где они управляют функциями приложения.
- аудитор, где они рассматривают транзакции приложения и предоставляют подробный отчет.
- инженер поддержки, где они помогают клиентам отлаживать и исправлять проблемы на своих счетах.
- клиент, где он взаимодействует с приложением и пользуется его услугами.

Чтобы справиться с этими применениями и любым другим вариантом использования для этого приложения, определения ролей устанавливаются (более широко известны как [RBAC](https://en.wikipedia.org/wiki/Role-based_access_control)). Основываясь на этих ролях, пользователь способен выполнить требуемую задачу.

## Цели теста

- Определите и задокументируйте роли, используемые приложением.
- Попытка переключиться, изменить или получить доступ к другой роли.
- Просмотрите детализацию ролей и потребностей, стоящих за предоставленными разрешениями.

## Как проверить

### Идентификация ролей

Тестер должен начать с определения ролей приложения, тестируемых любым из следующих методов:

- Документация по применению.
- Руководство разработчиков или администраторов приложения.
- Приложение комментариев.
- fuzz возможных ролей
    - cookie variable (*e.g.* `role=admin`, `isAdmin=True`)
    - account variable (*e.g.* `Role: manager`)
    - hidden directories or files (*e.g.* `/admin`, `/mod`, `/backups`)
    - switching to well known users (*e.g.* `admin`, `backups`, etc.)

### Переключение на доступные роли

После определения возможных векторов атаки тестер должен проверить и подтвердить, что они могут получить доступ к доступным ролям.

> Некоторые приложения определяют роли пользователя в создании посредством строгих проверок и политик или путем обеспечения надлежащей защиты роли пользователя с помощью подписи, созданной бэкэндом. Поиск ролей не означает, что они уязвимы.

### Обзор Роли Разрешения

Получив доступ к ролям в системе, тестер должен понять разрешения, предоставляемые каждой роли.

Инженер поддержки не должен иметь возможности выполнять административные функции, управлять резервными копиями или проводить какие-либо транзакции вместо пользователя.

Администратор не должен иметь полных полномочий в системе. Чувствительная функциональность администратора должна использовать принцип maker-checker или использовать MFA, чтобы гарантировать, что администратор проводит транзакцию. Ярким примером этого был [Twitter incident in 2020](https://blog.twitter.com/en_us/topics/company/2020/an-update-on-our-security-incident.html).

## Инструменты

Вышеупомянутые тесты могут проводиться без использования какого-либо инструмента, кроме того, который используется для доступа к системе.

Чтобы сделать вещи проще и документированнее, можно использовать:

- [Burp's Autorize extension](https://github.com/Quitten/Autorize)
- [ZAP's Access Control Testing add-on](https://www.zaproxy.org/docs/desktop/addons/access-control-testing/)

## References

- [Role Engineering for Enterprise Security Management, E Coyne & J Davis, 2007](https://www.bookdepository.co.uk/Role-Engineering-for-Enterprise-Security-Management-Edward-Coyne/9781596932180)
- [Role engineering and RBAC standards](https://csrc.nist.gov/projects/role-based-access-control#rbac-standard)
